# Структура каталогов

## Корневой каталог проекта

`/project-name/`

## Каталоги проекта

`/project-name/compiler-name` - содержит файл workspace и прочие, необходимые и генерируемые IDE при создании проекта

`/project-name/compiler-name/app` - файлы `main` и `version_file.h`

`/project-name/lib` - сторонние библиотеки (желательно подключённые как `submodules`)

`/project-name/inc` - заголовочные файлы

`/project-name/src` - source файлы (`*.c` и `*.cpp`)

`/project-name/tests` - файлы для тестирования

---------------------------------------------------------

# Version File

Заголовочный файл, содержащий версию прошивки.

Пример определения файла

```c
#undef VERSION
#define VERSION "Version 1.30"
```

Пример содержания:

```c
/***
Version Module-Project SAMPLE

Copyright 2007 Company
All Rights Reserved

The information contained herein is confidential
property of Company. The use, copying, transfer or
disclosure of such information is prohibited except
by express written agreement with Company.

12/18/07-Version 1.3-ROM ID 78-130
    Modified module AD_TO_D to fix scaling
    algorithm; instead of y = mx, it now
    computes y =mx+ b.
10/29/07-Version 1.2-ROM ID 78-120
    Changed modules DISPLAY_LED and READ_DIP
    to incorporate marketing ’s request for a
    diagnostics mode.
09/03/07-Version 1.1-ROM ID 78-110
    Changed module ISR to properly handle
    non-reentrant math problem.
07/12/07-Version 1.0-ROM ID 78-100
    Initial release
***/
#undef VERSION
#define VERSION "Version 1.30"
```

**Примечание** - в IAR попробовал просто define, но не получилось прочитать такую строку через J-Flasher. Удачная попытка была только при объявлении **локальной** переменной в `main()`.

# Структура отдельных файлов

## Source Files

### Структура файла

1) Блок комментариев
2) include
3) defines
4) типы данных
5) константы
6) макросы
7) объявление static переменных
8) прототипы private функций
9) определения public функций, объявленных в заголовочном файле
10) определения private функций

### Шаблон

```c
/**
  ******************************************************************************
  * @file    header.c
  *
  * @brief   Файл содержит реализацию функций для работы с
  *
  * @author  НПП АМЭ, Челушкин Михаил <chelushkin_mn@nppame.ru>
  *
  ******************************************************************************
  * @attention
  *
  * ДАННОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ «КАК ЕСТЬ», БЕЗ КАКИХ-ЛИБО
  * ГАРАНТИЙ, ЯВНО ВЫРАЖЕННЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ ГАРАНТИИ ТОВАРНОЙ
  * ПРИГОДНОСТИ, СООТВЕТСТВИЯ ПО ЕГО КОНКРЕТНОМУ НАЗНАЧЕНИЮ И ОТСУТСТВИЯ
  * НАРУШЕНИЙ, НО НЕ ОГРАНИЧИВАЯСЬ ИМИ. ДАННОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ
  * ПРЕДНАЗНАЧЕНО ДЛЯ ОЗНАКОМИТЕЛЬНЫХ ЦЕЛЕЙ И НАПРАВЛЕНО ТОЛЬКО НА
  * ПРЕДОСТАВЛЕНИЕ ДОПОЛНИТЕЛЬНОЙ ИНФОРМАЦИИ О ПРОДУКТЕ, С ЦЕЛЬЮ СОХРАНИТЬ ВРЕМЯ
  * ПОТРЕБИТЕЛЮ. НИ В КАКОМ СЛУЧАЕ АВТОРЫ ИЛИ ПРАВООБЛАДАТЕЛИ НЕ НЕСУТ
  * ОТВЕТСТВЕННОСТИ ПО КАКИМ-ЛИБО ИСКАМ, ЗА ПРЯМОЙ ИЛИ КОСВЕННЫЙ УЩЕРБ, ИЛИ
  * ПО ИНЫМ ТРЕБОВАНИЯМ, ВОЗНИКШИМ ИЗ-ЗА ИСПОЛЬЗОВАНИЯ ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ
  * ИЛИ ИНЫХ ДЕЙСТВИЙ С ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ.
  *
  * <h2><center>&copy; 2024 ОАО НПП "АМЭ"</center></h2>
  ******************************************************************************
  */

//-- Includes ------------------------------------------------------------------
#include "header.h"

//-- Defines -------------------------------------------------------------------
#define VOLGA 0

//-- Types ---------------------------------------------------------------------
/**
  * @brief  Числа
  */
typedef enum {
    one,    /*!< Один */
    two,    /*!< Два */
} NUMS;

//-- Constants -----------------------------------------------------------------
const char *s = "Const";

//-- Macro ---------------------------------------------------------------------
#define ABS(X) ((X) > 0 ? (X) : (-(X)))

//-- Variables -----------------------------------------------------------------
int big = 1000;

static small = 10;

//-- Prototypes of Private Functions -------------------------------------------
void func_priv(int num1, int num2);

//-- Public Functions ----------------------------------------------------------
/**
  * @brief   Настройка частоты SCL врежиме FS
  * @param   num1  Первый параметр
  * @param   num2  Второй параметр
  * @retval  void
  */
void func(int num1, int num2)
{

}

//-- Private Functions ---------------------------------------------------------
/**
  * @brief   Настройка частоты SCL врежиме FS
  * @param   num1  Первый параметр
  * @param   num2  Второй параметр
  * @retval  void
  */
void func_priv(int num1, int num2)
{

}

```

## Заголовочные файлы

### Структура файла

1) Блок комментариев
2) Защита от множественного включения файла
3) Обёртка при использовании C++
4) includes
5) defines
6) типы данных
7) ? макросы
8) определения public функций

### Шаблон

```c
/**
  ******************************************************************************
  * @file    header.h
  *
  * @brief   Файл содержит прототипы, а также сопутствующие макроопределения и перечисления
  *
  * @author  НПП АМЭ, Челушкин Михаил <chelushkin_mn@nppame.ru>
  *
  ******************************************************************************
  * @attention
  *
  * ДАННОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ ПРЕДОСТАВЛЯЕТСЯ «КАК ЕСТЬ», БЕЗ КАКИХ-ЛИБО
  * ГАРАНТИЙ, ЯВНО ВЫРАЖЕННЫХ ИЛИ ПОДРАЗУМЕВАЕМЫХ, ВКЛЮЧАЯ ГАРАНТИИ ТОВАРНОЙ
  * ПРИГОДНОСТИ, СООТВЕТСТВИЯ ПО ЕГО КОНКРЕТНОМУ НАЗНАЧЕНИЮ И ОТСУТСТВИЯ
  * НАРУШЕНИЙ, НО НЕ ОГРАНИЧИВАЯСЬ ИМИ. ДАННОЕ ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ
  * ПРЕДНАЗНАЧЕНО ДЛЯ ОЗНАКОМИТЕЛЬНЫХ ЦЕЛЕЙ И НАПРАВЛЕНО ТОЛЬКО НА
  * ПРЕДОСТАВЛЕНИЕ ДОПОЛНИТЕЛЬНОЙ ИНФОРМАЦИИ О ПРОДУКТЕ, С ЦЕЛЬЮ СОХРАНИТЬ ВРЕМЯ
  * ПОТРЕБИТЕЛЮ. НИ В КАКОМ СЛУЧАЕ АВТОРЫ ИЛИ ПРАВООБЛАДАТЕЛИ НЕ НЕСУТ
  * ОТВЕТСТВЕННОСТИ ПО КАКИМ-ЛИБО ИСКАМ, ЗА ПРЯМОЙ ИЛИ КОСВЕННЫЙ УЩЕРБ, ИЛИ
  * ПО ИНЫМ ТРЕБОВАНИЯМ, ВОЗНИКШИМ ИЗ-ЗА ИСПОЛЬЗОВАНИЯ ПРОГРАММНОГО ОБЕСПЕЧЕНИЯ
  * ИЛИ ИНЫХ ДЕЙСТВИЙ С ПРОГРАММНЫМ ОБЕСПЕЧЕНИЕМ.
  *
  * <h2><center>&copy; 2024 ОАО НПП "АМЭ"</center></h2>
  ******************************************************************************
  */

#ifndef HEADER_H
#define HEADER_H

#ifdef __cplusplus
extern "C" {
#endif

//-- Includes ------------------------------------------------------------------
#include <stdint.h>

//-- Defines -------------------------------------------------------------------
#define BIBA 0X01

//-- Types -------------------------------------------------------------------
/**
  * @brief  Числа
  */
typedef enum {
    one,    /*!< Один */
    two,    /*!< Два */
} NUMS;

//-- Functions -----------------------------------------------------------------
/**
  * @brief   Настройка частоты SCL врежиме FS
  * @param   num1  Первый параметр
  * @param   num2  Второй параметр
  * @retval  void
  */
void func(int num1, int num2);


#ifdef __cplusplus
}
#endif

#endif // HEADER_H
```